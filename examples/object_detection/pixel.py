import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression

# -------------------------------
# dataset (X, Y, u, v)
# -------------------------------
data = [
    (14.5, 0, 352, 3),
    (14.5, 1, 351, 28),
    (14.5, 2, 349, 54),
    (14.5, 3, 348, 80),
    (14.5, 4, 346, 106),
    (14.5, 5, 345, 133),
    (14.5, 6, 344, 159),
    (14.5, 7, 343, 186),
    (14.5, 8, 342, 212),
    (14.5, 9, 340, 238),
    (14.5, 10, 339, 265),
    (14.5, 11, 337, 292),
    (14.5, 12, 336, 318),
    (14.5, 13, 334, 345),
    (14.5, 14, 333, 372),
    (14.5, 15, 331, 399),
    (14.5, 16, 329, 426),
    (14.5, 17, 327, 453),
    (14.5, 18, 326, 480),
    (14.5, 19, 324, 508),
    (15.5, 0, 377, 3),
    (15.5, 1, 376, 28),
    (15.5, 2, 374, 53),
    (15.5, 3, 372, 80),
    (15.5, 4, 371, 106),
    (15.5, 5, 370, 133),
    (15.5, 6, 369, 159),
    (15.5, 7, 368, 186),
    (15.5, 8, 366, 212),
    (15.5, 9, 365, 239),
    (15.5, 10, 363, 265),
    (15.5, 11, 361, 292),
    (15.5, 12, 360, 319),
    (15.5, 13, 358, 346),
    (15.5, 14, 357, 373),
    (15.5, 15, 355, 400),
    (15.5, 16, 354, 427),
    (15.5, 17, 352, 454),
    (15.5, 18, 351, 481),
    (15.5, 19, 350, 509),
    (16.5, 0, 402, 3),
    (16.5, 1, 401, 27),
    (16.5, 2, 400, 53),
    (16.5, 3, 398, 80),
    (16.5, 4, 397, 106),
    (16.5, 5, 396, 133),
    (16.5, 6, 395, 160),
    (16.5, 7, 393, 186),
    (16.5, 8, 392, 213),
    (16.5, 9, 391, 239),
    (16.5, 10, 389, 266),
    (16.5, 11, 388, 292),
    (16.5, 12, 386, 319),
    (16.5, 13, 385, 346),
    (16.5, 14, 383, 374),
    (16.5, 15, 382, 401),
    (16.5, 16, 380, 428),
    (16.5, 17, 379, 455),
    (16.5, 18, 377, 482),
    (16.5, 19, 377, 509),
    (17.5, 0, 428, 3),
    (17.5, 1, 427, 27),
    (17.5, 2, 426, 53),
    (17.5, 3, 425, 79),
    (17.5, 4, 423, 106),
    (17.5, 5, 422, 133),
    (17.5, 6, 421, 160),
    (17.5, 7, 420, 186),
    (17.5, 8, 418, 213),
    (17.5, 9, 417, 240),
    (17.5, 10, 415, 267),
    (17.5, 11, 414, 294),
    (17.5, 12, 413, 321),
    (17.5, 13, 411, 348),
    (17.5, 14, 410, 375),
    (17.5, 15, 408, 402),
    (17.5, 16, 406, 429),
    (17.5, 17, 405, 457),
    (17.5, 18, 404, 484),
    (17.5, 19, 403, 511),
    (18.5, 0, 454, 2),
    (18.5, 1, 453, 27),
    (18.5, 2, 452, 53),
    (18.5, 3, 451, 80),
    (18.5, 4, 449, 107),
    (18.5, 5, 448, 133),
    (18.5, 6, 447, 160),
    (18.5, 7, 446, 187),
    (18.5, 8, 444, 213),
    (18.5, 9, 443, 240),
    (18.5, 10, 442, 267),
    (18.5, 11, 440, 294),
    (18.5, 12, 439, 321),
    (18.5, 13, 438, 348),
    (18.5, 14, 436, 375),
    (18.5, 15, 435, 403),
    (18.5, 16, 433, 430),
    (18.5, 17, 432, 458),
    (18.5, 18, 431, 485),
    (18.5, 19, 430, 512),
    (19.5, 0, 481, 1),
    (19.5, 1, 480, 27),
    (19.5, 2, 478, 53),
    (19.5, 3, 477, 80),
    (19.5, 4, 476, 107),
    (19.5, 5, 474, 133),
    (19.5, 6, 473, 160),
    (19.5, 7, 472, 187),
    (19.5, 8, 471, 214),
    (19.5, 9, 470, 241),
    (19.5, 10, 469, 268),
    (19.5, 11, 467, 295),
    (19.5, 12, 466, 322),
    (19.5, 13, 464, 349),
    (19.5, 14, 463, 377),
    (19.5, 15, 461, 404),
    (19.5, 16, 460, 431),
    (19.5, 17, 459, 459),
    (19.5, 18, 457, 486),
    (19.5, 19, 457, 514),
    (20.5, 0, 507, 1),
    (20.5, 1, 506, 27),
    (20.5, 2, 505, 54),
    (20.5, 3, 503, 80),
    (20.5, 4, 502, 107),
    (20.5, 5, 501, 134),
    (20.5, 6, 500, 161),
    (20.5, 7, 499, 188),
    (20.5, 8, 497, 215),
    (20.5, 9, 496, 242),
    (20.5, 10, 495, 269),
    (20.5, 11, 494, 296),
    (20.5, 12, 492, 323),
    (20.5, 13, 491, 350),
    (20.5, 14, 490, 378),
    (20.5, 15, 489, 405),
    (20.5, 16, 487, 432),
    (20.5, 17, 486, 460),
    (20.5, 18, 485, 488),
    (20.5, 19, 483, 516),
    (21.5, 0, 533, 0),
    (21.5, 1, 533, 27),
    (21.5, 2, 531, 54),
    (21.5, 3, 530, 81),
    (21.5, 4, 529, 108),
    (21.5, 5, 528, 134),
    (21.5, 6, 527, 161),
    (21.5, 7, 526, 188),
    (21.5, 8, 525, 215),
    (21.5, 9, 523, 243),
    (21.5, 10, 522, 270),
    (21.5, 11, 521, 297),
    (21.5, 12, 519, 324),
    (21.5, 13, 518, 351),
    (21.5, 14, 517, 379),
    (21.5, 15, 516, 406),
    (21.5, 16, 515, 434),
    (21.5, 17, 513, 461),
    (21.5, 18, 512, 489),
    (21.5, 19, 511, 517),
    (22.5, 0, 560, 0),
    (22.5, 1, 559, 27),
    (22.5, 2, 558, 54),
    (22.5, 3, 557, 81),
    (22.5, 4, 556, 108),
    (22.5, 5, 555, 135),
    (22.5, 6, 554, 162),
    (22.5, 7, 552, 189),
    (22.5, 8, 551, 216),
    (22.5, 9, 550, 243),
    (22.5, 10, 549, 271),
    (22.5, 11, 548, 298),
    (22.5, 12, 547, 325),
    (22.5, 13, 545, 352),
    (22.5, 14, 544, 380),
    (22.5, 15, 543, 407),
    (22.5, 16, 542, 435),
    (22.5, 17, 540, 463),
    (22.5, 18, 539, 490),
    (22.5, 19, 538, 518),
    (23.5, 0, 587, 0),
    (23.5, 1, 586, 28),
    (23.5, 2, 585, 54),
    (23.5, 3, 584, 81),
    (23.5, 4, 583, 108),
    (23.5, 5, 582, 135),
    (23.5, 6, 581, 163),
    (23.5, 7, 580, 189),
    (23.5, 8, 578, 216),
    (23.5, 9, 577, 244),
    (23.5, 10, 576, 271),
    (23.5, 11, 575, 299),
    (23.5, 12, 574, 326),
    (23.5, 13, 573, 353),
    (23.5, 14, 571, 381),
    (23.5, 15, 570, 409),
    (23.5, 16, 569, 436),
    (23.5, 17, 568, 464),
    (23.5, 18, 567, 492),
    (23.5, 19, 566, 519),
    (24.5, 0, 614, 0),
    (24.5, 1, 613, 28),
    (24.5, 2, 612, 54),
    (24.5, 3, 611, 82),
    (24.5, 4, 610, 109),
    (24.5, 5, 609, 135),
    (24.5, 6, 608, 163),
    (24.5, 7, 607, 190),
    (24.5, 8, 606, 217),
    (24.5, 9, 605, 244),
    (24.5, 10, 604, 272),
    (24.5, 11, 602, 299),
    (24.5, 12, 601, 327),
    (24.5, 13, 600, 354),
    (24.5, 14, 599, 382),
    (24.5, 15, 598, 410),
    (24.5, 16, 597, 437),
    (24.5, 17, 595, 465),
    (24.5, 18, 594, 493),
    (24.5, 19, 593, 521),
    (25.5, 0, 641, 0),
    (25.5, 1, 640, 28),
    (25.5, 2, 639, 55),
    (25.5, 3, 638, 82),
    (25.5, 4, 637, 109),
    (25.5, 5, 636, 136),
    (25.5, 6, 635, 163),
    (25.5, 7, 634, 190),
    (25.5, 8, 633, 218),
    (25.5, 9, 632, 245),
    (25.5, 10, 631, 273),
    (25.5, 11, 630, 300),
    (25.5, 12, 629, 328),
    (25.5, 13, 627, 355),
    (25.5, 14, 626, 383),
    (25.5, 15, 625, 411),
    (25.5, 16, 624, 439),
    (25.5, 17, 623, 465),
    (25.5, 18, 622, 495),
    (25.5, 19, 621, 522),
    (26.5, 0, 669, 0),
    (26.5, 1, 668, 28),
    (26.5, 2, 667, 55),
    (26.5, 3, 666, 82),
    (26.5, 4, 665, 109),
    (26.5, 5, 664, 136),
    (26.5, 6, 663, 164),
    (26.5, 7, 662, 191),
    (26.5, 8, 661, 218),
    (26.5, 9, 660, 246),
    (26.5, 10, 659, 273),
    (26.5, 11, 658, 301),
    (26.5, 12, 656, 329),
    (26.5, 13, 655, 357),
    (26.5, 14, 654, 384),
    (26.5, 15, 653, 412),
    (26.5, 16, 652, 440),
    (26.5, 17, 651, 468),
    (26.5, 18, 650, 496),
    (26.5, 19, 649, 524),
    (27.5, 0, 696, 0),
    (27.5, 1, 695, 27),
    (27.5, 2, 694, 55),
    (27.5, 3, 693, 82),
    (27.5, 4, 692, 109),
    (27.5, 5, 691, 137),
    (27.5, 6, 690, 164),
    (27.5, 7, 689, 191),
    (27.5, 8, 688, 219),
    (27.5, 9, 687, 246),
    (27.5, 10, 686, 274),
    (27.5, 11, 685, 302),
    (27.5, 12, 684, 330),
    (27.5, 13, 683, 358),
    (27.5, 14, 682, 386),
    (27.5, 15, 681, 413),
    (27.5, 16, 680, 441),
    (27.5, 17, 679, 469),
    (27.5, 18, 678, 497),
    (27.5, 19, 677, 526),
    (28.5, 0, 724, 0),
    (28.5, 1, 723, 27),
    (28.5, 2, 722, 54),
    (28.5, 3, 721, 82),
    (28.5, 4, 720, 109),
    (28.5, 5, 719, 137),
    (28.5, 6, 718, 165),
    (28.5, 7, 717, 192),
    (28.5, 8, 716, 219),
    (28.5, 9, 715, 247),
    (28.5, 10, 714, 275),
    (28.5, 11, 713, 303),
    (28.5, 12, 712, 331),
    (28.5, 13, 711, 358),
    (28.5, 14, 710, 386),
    (28.5, 15, 709, 414),
    (28.5, 16, 708, 442),
    (28.5, 17, 707, 471),
    (28.5, 18, 706, 499),
    (28.5, 19, 705, 527),
    (29.5, 0, 752, 0),
    (29.5, 1, 751, 28),
    (29.5, 2, 750, 55),
    (29.5, 3, 749, 82),
    (29.5, 4, 748, 110),
    (29.5, 5, 747, 137),
    (29.5, 6, 746, 165),
    (29.5, 7, 745, 193),
    (29.5, 8, 744, 221),
    (29.5, 9, 743, 248),
    (29.5, 10, 742, 276),
    (29.5, 11, 741, 304),
    (29.5, 12, 740, 332),
    (29.5, 13, 739, 360),
    (29.5, 14, 738, 388),
    (29.5, 15, 737, 416),
    (29.5, 16, 736, 444),
    (29.5, 17, 735, 472),
    (29.5, 18, 734, 501),
    (30.5, 0, 779, 0),
    (30.5, 1, 779, 27),
    (30.5, 2, 778, 55),
    (30.5, 3, 777, 82),
    (30.5, 4, 776, 110),
    (30.5, 5, 775, 137),
    (30.5, 6, 774, 165),
    (30.5, 7, 773, 193),
    (30.5, 8, 772, 221),
    (30.5, 9, 771, 248),
    (30.5, 10, 770, 276),
    (30.5, 11, 769, 304),
    (30.5, 12, 768, 332),
    (30.5, 13, 767, 360),
    (30.5, 14, 766, 389),
    (30.5, 15, 765, 417),
    (30.5, 16, 765, 445),
    (30.5, 17, 764, 473),
    (30.5, 18, 763, 502),
    (31.5, 0, 808, 0),
    (31.5, 1, 807, 27),
    (31.5, 2, 806, 56),
    (31.5, 3, 805, 83),
    (31.5, 4, 804, 110),
    (31.5, 5, 803, 138),
    (31.5, 6, 802, 166),
    (31.5, 7, 801, 193),
    (31.5, 8, 801, 221),
    (31.5, 9, 800, 249),
    (31.5, 10, 799, 277),
    (31.5, 11, 797, 305),
    (31.5, 12, 797, 333),
    (31.5, 13, 796, 361),
    (31.5, 14, 795, 390),
    (31.5, 15, 794, 418),
    (31.5, 16, 793, 446),
    (31.5, 17, 792, 474),
    (31.5, 18, 791, 503),
    (32.5, 0, 836, 0),
    (32.5, 1, 835, 28),
    (32.5, 2, 834, 55),
    (32.5, 3, 833, 83),
    (32.5, 4, 833, 111),
    (32.5, 5, 832, 138),
    (32.5, 6, 831, 166),
    (32.5, 7, 830, 194),
    (32.5, 8, 829,222),
    (32.5,9 ,828 ,250),
    (32.5 ,10 ,827 ,278),
    (32.5 ,11 ,826 ,306),
    (32.5 ,12 ,825 ,334),
    (32.5 ,13 ,824 ,363),
    (32.5 ,14 ,824 ,391),
    (32.5 ,15 ,823 ,419),
    (32.5 ,16 ,822 ,448),
    (32.5 ,17 ,821 ,476),
    (32.5 ,18 ,820 ,505),
    (32.5 ,19 ,819,534),
    (33.5, 0, 864, 0),
    (33.5, 1, 863, 28),
    (33.5, 2, 863, 56),
    (33.5, 3, 862, 83),
    (33.5, 4, 861, 111),
    (33.5, 5, 860, 139),
    (33.5, 6, 860, 166),
    (33.5, 7, 859, 195),
    (33.5, 8, 858, 222),
    (33.5, 9, 857, 250),
    (33.5, 10, 856, 279),
    (33.5, 11, 855, 307),
    (33.5, 12, 854, 335),
    (33.5, 13, 853, 363),
    (33.5, 14, 853, 392),
    (33.5, 15, 852, 420),
    (33.5, 16, 851, 449),
    (33.5, 17, 850, 478),
    (33.5, 18, 849, 506),
    (33.5, 19, 848, 535),
    (34.5, 0, 892, 0),
    (34.5, 1, 892, 28),
    (34.5, 2, 891, 55),
    (34.5, 3, 891, 83),
    (34.5, 4, 890, 111),
    (34.5, 5, 889, 139),
    (34.5, 6, 889, 167),
    (34.5, 7, 888, 195),
    (34.5, 8, 887, 223),
    (34.5, 9, 886, 251),
    (34.5, 10, 885, 279),
    (34.5, 11, 884, 308),
    (34.5, 12, 883, 336),
    (34.5, 13, 882, 364),
    (34.5, 14, 882, 393),
    (34.5, 15, 881, 422),
    (34.5, 16, 880, 450),
    (34.5, 17, 879, 479),
    (34.5, 18, 878, 508),
    (34.5, 19, 877, 536),
    (35.5, 0, 921, 2),
    (35.5, 1, 921, 29),
    (35.5, 2, 920, 56),
    (35.5, 3, 919, 84),
    (35.5, 4, 919, 111),
    (35.5, 5, 918, 139),
    (35.5, 6, 917, 167),
    (35.5, 7, 917, 196),
    (35.5, 8, 916, 223),
    (35.5, 9, 915, 252),
    (35.5, 10, 914, 280),
    (35.5, 11, 913, 309),
    (35.5, 12, 913, 337),
    (35.5, 13, 911, 366),
    (35.5, 14, 911, 394),
    (35.5, 15, 910, 423),
    (35.5, 16, 909, 452),
    (35.5, 17, 909, 480),
    (35.5, 18, 908, 509),
    (35.5, 19, 907, 537),
    (36.5, 0, 950, 2),
    (36.5, 1, 949, 28),
    (36.5, 2, 949, 56),
    (36.5, 3, 948, 84),
    (36.5, 4, 948, 112),
    (36.5, 5, 947, 140),
    (36.5, 6, 946, 168),
    (36.5, 7, 946, 196),
    (36.5, 8, 945, 224),
    (36.5, 9, 944, 253),
    (36.5, 10, 943, 281),
    (36.5, 11, 942, 309),
    (36.5, 12, 942, 338),
    (36.5, 13, 941, 367),
    (36.5, 14, 940, 396),
    (36.5, 15, 939, 424),
    (36.5, 16, 939, 453),
    (36.5, 17, 938, 482),
    (36.5, 18, 937, 511),
    (36.5, 19, 936, 539),
    (37.5, 0, 978, 2),
    (37.5, 1, 978, 29),
    (37.5, 2, 978, 56),
    (37.5, 3, 977, 84),
    (37.5, 4, 977, 112),
    (37.5, 5, 976, 140),
    (37.5, 6, 975, 169),
    (37.5, 7, 975, 196),
    (37.5, 8, 974, 225),
    (37.5, 9, 973, 253),
    (37.5, 10, 972, 282),
    (37.5, 11, 972, 310),
    (37.5, 12, 971, 339),
    (37.5, 13, 970, 368),
    (37.5, 14, 969, 397),
    (37.5, 15, 968, 425),
    (37.5, 16, 968, 454),
    (37.5, 17, 967, 483),
    (37.5, 18, 966, 512),
    (37.5, 19, 965, 541),
    (38.5, 0, 1007, 3),
    (38.5, 1, 1007, 29),
    (38.5, 2, 1007, 57),
    (38.5, 3, 1006, 85),
    (38.5, 4, 1005, 113),
    (38.5, 5, 1005, 141),
    (38.5, 6, 1004, 169),
    (38.5, 7, 1004, 197),
    (38.5, 8, 1003, 225),
    (38.5, 9, 1002, 254),
    (38.5, 10, 1002, 282),
    (38.5, 11, 1001, 311),
    (38.5, 12, 1000, 340),
    (38.5, 13, 999, 369),
    (38.5, 14, 998, 398),
    (38.5, 15, 998, 427),
    (38.5, 16, 997, 455),
    (38.5, 17, 997, 484),
    (38.5, 18, 996, 513),
    (38.5, 19, 995, 542),
    (39.5, 0, 1036, 3),
    (39.5, 1, 1036, 30),
    (39.5, 2, 1035, 57),
    (39.5, 3, 1035, 85),
    (39.5, 4, 1034, 113),
    (39.5, 5, 1034, 142),
    (39.5, 6, 1034, 169),
    (39.5, 7, 1034, 198),
    (39.5, 8, 1033, 226),
    (39.5, 9, 1032, 255),
    (39.5, 10, 1031, 283),
    (39.5, 11, 1031, 312),
    (39.5, 12, 1030, 341),
    (39.5, 13, 1029, 370),
    (39.5, 14, 1028, 399),
    (39.5, 15, 1028, 428),
    (39.5, 16, 1027, 457),
    (39.5, 17, 1026, 486),
    (39.5, 18, 1026, 515),
    (39.5, 19, 1025, 543),
    (40.5, 0, 1065, 3),
    (40.5, 1, 1065, 30),
    (40.5, 2, 1064, 58),
    (40.5, 3, 1064, 85),
    (40.5, 4, 1064, 114),
    (40.5, 5, 1063, 142),
    (40.5, 6, 1063, 170),
    (40.5, 7, 1063, 199),
    (40.5, 8, 1062, 227),
    (40.5, 9, 1061, 256),
    (40.5, 10, 1061, 284),
    (40.5, 11, 1060, 313),
    (40.5, 12, 1060, 342),
    (40.5, 13, 1059, 371),
    (40.5, 14, 1058, 400),
    (40.5, 15, 1057, 429),
    (40.5, 16, 1057, 458),
    (40.5, 17, 1056, 487),
    (40.5, 18, 1055, 516),
    (40.5, 19, 1054, 545),
    (41.5, 0, 1093, 4),
    (41.5, 1, 1093, 31),
    (41.5, 2, 1093, 58),
    (41.5, 3, 1093, 86),
    (41.5, 4, 1093, 114),
    (41.5, 5, 1093, 143),
    (41.5, 6, 1092, 171),
    (41.5, 7, 1092, 200),
    (41.5, 8, 1091, 228),
    (41.5, 9, 1090, 257),
    (41.5, 10, 1090, 285),
    (41.5, 11, 1090, 314),
    (41.5, 12, 1089, 343),
    (41.5, 13, 1088, 372),
    (41.5, 14, 1088, 401),
    (41.5, 15, 1087, 430),
    (41.5, 16, 1087, 459),
    (41.5, 17, 1086, 489),
    (41.5, 18, 1085, 518),
    (41.5, 19, 1084, 546),
    (42.5, 0, 1123, 5),
    (42.5, 1, 1123, 31),
    (42.5, 2, 1122, 59),
    (42.5, 3, 1121, 87),
    (42.5, 4, 1121, 115),
    (42.5, 5, 1121, 143),
    (42.5, 6, 1121, 172),
    (42.5, 7, 1121, 200),
    (42.5, 8, 1120, 229),
    (42.5, 9, 1120, 257),
    (42.5, 10, 1120, 286),
    (42.5, 11, 1120, 315),
    (42.5, 12, 1120, 344),
    (42.5, 13, 1118, 373),
    (42.5, 14, 1118, 403),
    (42.5, 15, 1117, 431),
    (42.5, 16, 1116, 460),
    (42.5, 17, 1115, 490),
    (42.5, 18, 1114, 519),
    (42.5, 19, 1113, 547),
]

df = pd.DataFrame(data, columns=["X", "Y", "u", "v"])

# -------------------------------
# Train inverse regression: pixel → world
# -------------------------------
U_train = df[["u", "v"]]

# สำหรับ X (cm)
model_x = LinearRegression().fit(U_train, df["X"])
print("Equation for X (cm):")
print(f"X = {model_x.intercept_:.2f} + {model_x.coef_[0]:.4f}*u + {model_x.coef_[1]:.4f}*v")

# สำหรับ Y (cm)
model_y = LinearRegression().fit(U_train, df["Y"])
print("\nEquation for Y (cm):")
print(f"Y = {model_y.intercept_:.2f} + {model_y.coef_[0]:.4f}*u + {model_y.coef_[1]:.4f}*v")

# -------------------------------
# ฟังก์ชัน pixel → world
# -------------------------------
def pixel_to_world(u, v):
    X_cm = model_x.predict([[u, v]])[0]
    Y_cm = model_y.predict([[u, v]])[0]
    return X_cm, Y_cm

# -------------------------------
# ทดสอบ
# -------------------------------
# u_test, v_test = 502, 107
# X, Y = pixel_to_world(u_test, v_test)
# print(f"\nPixel ({u}, {v}) → World ({X:.2f} cm, {Y:.2f} cm)")
